
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>本の詳細</title>
    <link rel="stylesheet" href="../static/css/bdetail.css">
</head>
<body>

<div class="header">
    <a href="home.html" class="home-link">
        <span class="material-icons">home</span> ホーム
    </a>
</div>

<div class="main-content">
    <img id="bookImage" class="book-image" src="" alt="本の画像">
    <div class="book-info">
        <p><strong>タイトル：</strong><span id="bookTitle"></span></p>
        <p><strong>著者：</strong><span id="bookAuthor"></span> &nbsp;&nbsp; <strong>出版社：</strong><span id="bookPublisher"></span></p>
        <p><strong>カテゴリ：</strong><span id="bookCategory"></span></p>
        <p><strong>あらすじ：</strong></p>
        <p id="bookDescription"></p>
    </div>
</div>

<div class="buttons">
    <button id="back">戻る</button>
    <button id="borrow">借りる</button>
</div>

<script>
// URLパラメータ取得
function getQueryParams() {
    const params = {};
    window.location.search.substring(1).split("&").forEach(pair => {
        const [key, value] = pair.split("=");
        if(key) params[key] = decodeURIComponent(value);
    });
    return params;
}

// 本情報表示
window.onload = function() {
    const params = getQueryParams();
    document.getElementById("bookTitle").textContent = params.title || "";
    document.getElementById("bookAuthor").textContent = params.author || "";
    document.getElementById("bookPublisher").textContent = params.publisher || "";
    document.getElementById("bookCategory").textContent = params.category || "";
    document.getElementById("bookDescription").textContent = params.description || "";
    document.getElementById("bookImage").src = params.image || "https://via.placeholder.com/150x210?text=No+Image";

    // 戻るボタンの挙動
    const backBtn = document.getElementById("back");
    const referrer = document.referrer; // 前のURL
    if(referrer.includes("search.html")) {
        backBtn.onclick = () => window.location.href = "search.html";
    } else if(referrer.includes("bookshelf.html")) {
        backBtn.onclick = () => window.location.href = "bookshelf.html";
    } else {
        backBtn.onclick = () => window.location.href = "home.html";
    }

    // 借りるボタン
    document.getElementById("borrow").onclick = function() {
        // lentconf.html に本情報を渡す
        const lentUrl = `lentconf.html?title=${encodeURIComponent(params.title)}&author=${encodeURIComponent(params.author)}&publisher=${encodeURIComponent(params.publisher)}&category=${encodeURIComponent(params.category)}&description=${encodeURIComponent(params.description)}&image=${encodeURIComponent(params.image)}`;
        window.location.href = lentUrl;
    };
};
</script>

</body>
</html>
