<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>本の詳細</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="../static/css/bdetail.css">
</head>
<body>

<div class="header">
    <a th:href="@{/home}" class="home-link">
        <span class="material-symbols-outlined book-icon">book</span>
        ホーム
    </a>

    <!-- 貸出可否を model に渡しておく（例: book.available = true/false） -->
    <div class="loan-status"
         th:classappend="${book.available} ? 'loan-available' : 'loan-unavailable'">
        貸し出し<br th:remove="tag">
        <span th:text="${book.available} ? '可' : '不可'"></span>
    </div>
</div>

<div class="main-content">

    <!-- 画像 -->
    <div class="book-image-container">
        <img id="bookImage"
             class="book-image"
             th:src="${book.image != null} ? ${book.image} : ''"
             th:if="${book.image != null}"
             alt="本の画像">

        <!-- 画像が無い場合表示 -->
        <div class="image-placeholder"
             th:if="${book.image == null}">
            本の画像
        </div>
    </div>

    <div class="book-info">
        <p class="info-line">
            <span class="info-label title-label">タイトル：</span>
            <span class="info-value title-value" th:text="${book.title}"></span>
        </p>

        <p class="info-line">
            <span class="info-label">著者：</span>
            <span class="info-value author-value" th:text="${book.author}"></span>

            <span class="publisher-group">
                <span class="info-label publisher-label">出版社：</span>
                <span class="info-value publisher-value" th:text="${book.publisher}"></span>
            </span>
        </p>

        <p class="info-line">
            <span class="info-label">カテゴリ：</span>
            <span class="info-value category-value" th:text="${book.category}"></span>
        </p>

        <p class="info-line abstract-label-line">
            <span class="info-label abstract-label">あらすじ</span>
        </p>

        <div class="abstract-box">
            <p class="abstract-text" th:text="${book.description}"></p>
        </div>
    </div>
</div>

<div class="buttons">
    <!-- 履歴戻るは JS しかないので、戻り先をサーバー側で指定 -->
    <a th:href="@{/books}" class="app-button back-button">戻る</a>

    <!-- 貸りるボタン（貸出不可なら disabled） -->
    <a th:href="@{/lentconf(title=${book.title}, author=${book.author}, publisher=${book.publisher}, category=${book.category}, description=${book.description}, image=${book.image})}"
       class="app-button borrow-button"
       th:classappend="${!book.available} ? ' disabled'">
       借りる
    </a>
</div>

</body>
</html>
