
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>書籍詳細 - 貸出・返却システム</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
/* 検索画面と揃えたCSS */
body { font-family: sans-serif; margin:0; padding:0; background-color:#f4f4f4; text-align:center; }
.header { display:flex; align-items:center; padding:10px 20px; background-color:#fff; box-shadow:0 2px 4px rgba(0,0,0,0.1); max-width:900px; margin:0 auto; justify-content:flex-start;}
.home-link { display:inline-flex; align-items:center; border:1px solid #000; border-radius:8px; padding:5px 15px; background:#fff; color:#000; text-decoration:none; cursor:pointer; font-size:1em;}
.home-link .material-icons { margin-right:5px; }
.main-content { display:flex; max-width:900px; margin:20px auto; background-color:#fff; border-radius:8px; padding:15px; box-shadow:0 1px 3px rgba(0,0,0,0.05); text-align:left;}
.book-image { width:150px; height:210px; border:1px solid #ccc; margin-right:20px; object-fit:cover;}
.book-info p { margin:5px 0; }
.buttons { display:flex; justify-content:center; gap:20px; margin:20px auto; max-width:900px;}
button { padding:10px 20px; border-radius:8px; border:none; cursor:pointer; font-size:1em;}
button#back { background-color:#ccc; }
button#borrow { background-color:#007bff; color:#fff; }
</style>
</head>
<body>

<div class="header">
    <a href="home.html" class="home-link">
        <span class="material-icons">home</span> ホーム
    </a>
</div>

<div class="main-content">
    <img id="bookImage" class="book-image" src="" alt="本の画像">
    <div class="book-info">
        <p><strong>タイトル：</strong><span id="bookTitle"></span></p>
        <p><strong>著者：</strong><span id="bookAuthor"></span> &nbsp;&nbsp; <strong>出版社：</strong><span id="bookPublisher"></span></p>
        <p><strong>カテゴリ：</strong><span id="bookCategory"></span></p>
        <p><strong>あらすじ：</strong></p>
        <p id="bookDescription"></p>
    </div>
</div>

<div class="buttons">
    <button id="back">戻る</button>
    <button id="borrow">借りる</button>
</div>

<script>
// URLパラメータ取得
function getQueryParams() {
    const params = {};
    window.location.search.substring(1).split("&").forEach(pair => {
        const [key, value] = pair.split("=");
        if(key) params[key] = decodeURIComponent(value);
    });
    return params;
}

// 本情報表示
window.onload = function() {
    const params = getQueryParams();
    document.getElementById("bookTitle").textContent = params.title || "";
    document.getElementById("bookAuthor").textContent = params.author || "";
    document.getElementById("bookPublisher").textContent = params.publisher || "";
    document.getElementById("bookCategory").textContent = params.category || "";
    document.getElementById("bookDescription").textContent = params.description || "";
    document.getElementById("bookImage").src = params.image || "https://via.placeholder.com/150x210?text=No+Image";

    // 戻るボタンの挙動
    const backBtn = document.getElementById("back");
    const referrer = document.referrer; // 前のURL
    if(referrer.includes("search.html")) {
        backBtn.onclick = () => window.location.href = "search.html";
    } else if(referrer.includes("bookshelf.html")) {
        backBtn.onclick = () => window.location.href = "bookshelf.html";
    } else {
        backBtn.onclick = () => window.location.href = "home.html";
    }

    // 借りるボタン
    document.getElementById("borrow").onclick = function() {
        // lentconf.html に本情報を渡す
        const lentUrl = `lentconf.html?title=${encodeURIComponent(params.title)}&author=${encodeURIComponent(params.author)}&publisher=${encodeURIComponent(params.publisher)}&category=${encodeURIComponent(params.category)}&description=${encodeURIComponent(params.description)}&image=${encodeURIComponent(params.image)}`;
        window.location.href = lentUrl;
    };
};
</script>

</body>
</html>
